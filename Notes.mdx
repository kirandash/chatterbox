## Chatterbox

### 1 Create a new project

- `npx create-react-app chatterbox-ui --template typescript`
- `npm i @mui/material @emotion/react @emotion/styled @fontsource/roboto @mui/icons-material`

### 2 Implement Dark Theme using MUI and some base styling

- `createTheme` API and `ThemeProvider` for dark theme
- `CssBaseline` for base styling

### 3 Login Form

### 4 Add routing with react router dom

- `npm i react-router-dom localforage match-sorter sort-by`
- packages: `react-router-dom`, `localforage`, `match-sorter`, `sort-by`
- react-router-dom is used for routing
- localforage is used for storing data in local storage
- match-sorter is used for sorting and filtering data
- sort-by is used for sorting data

### 5 NestJS BE setup

- install nestjs globally: `npm i -g @nestjs/cli`
- create a new nestjs project: `nest new chatterbox-be`
- `pnpm run start:dev` to start the server

### 6 Setup MongoDB

- `pnpm i @nestjs/config @nestjs/mongoose mongoose`
- @nestjs/config: Configuration module for Nest
- @nestjs/mongoose: Mongoose module for Nest
- mongoose: MongoDB object modeling tool
- `pnpm i joi` for validation
  - will validate env variables as well
- mongodb installation: https://www.mongodb.com/docs/manual/installation/
- install mongo for mac: https://www.mongodb.com/docs/manual/tutorial/install-mongodb-on-os-x/
- create a folder data/db in ~ and from ~ run: `mongod --dbpath=data/db`
- run be: `pnpm run start:dev` and check if the connection is successful
  - mongod should log "msg":"Connection accepted"
  - be should log "MongooseCoreModule dependencies initialized"
  - if already running please kill the process.
    - `ps aux | grep mongod`
    - `kill <processid>`

### 7 Setup graphql and apollo, users resources

- `pnpm i @nestjs/graphql @nestjs/apollo @apollo/server graphql`
- graphql playground: http://localhost:3000/graphql
- `nest g resource users`

### 8 Abstract Schema and Abstract Repository

- abstract schema for common fields
- abstract repository for common methods

### 9 User CRUD, User Entity and User Repository, Refactor Abstract entity, Abstract repository

### 10 User CRUD continued

- `pnpm i bcrypt` and `pnpm i -D @types/bcrypt`
- sample graphql queries and mutations:
- createUser:

```
mutation {
  createUser(createUserInput:{
    email:"user1@kirandash.com",
    password: "password123"
  }) {
    _id
    email
  }
}
```

### 11 MongoDB compass

- https://www.mongodb.com/try/download/compass
- connect to mongodb://localhost:27017/chatterbox

### 12 Add logging with pino logger

- https://github.com/pinojs/pino
- Docs: https://www.npmjs.com/package/nestjs-pino
- `pnpm i nestjs-pino pino-http pino-pretty`

### 13 Modify logging config for production

### 14 DB Migrations - up and down

- we will use https://www.npmjs.com/package/migrate-mongo
- `pnpm i migrate-mongo`
- type: `pnpm i -D @types/migrate-mongo`
- `pnpm i mongodb`: to get access to the types
- create migration for user email index and make it unique
- we can use this for validation to make sure we don't have duplicate emails
- in mongo client we should be able to see `email_1` index
- and in changelog we should see the migration file details
